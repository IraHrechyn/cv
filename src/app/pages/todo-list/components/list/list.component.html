<p-table
  [value]="todoService.m.filteredTodos"
  dataKey="id"
  editMode="row"
  [(selection)]="todoService.m.selectedTodos"
  [paginator]="todoService.m.filteredTodos.length > 10"
  [rows]="10"
  [totalRecords]="todoService.m.filteredTodos.length || 0">

  <ng-template pTemplate="header">
    <tr>
        <th style="width: 4rem"><p-tableHeaderCheckbox></p-tableHeaderCheckbox></th>
        <th pSortableColumn="title" style="width:50%" >Case <p-sortIcon field="title" ></p-sortIcon></th>
        <th pSortableColumn="completed">Status <p-sortIcon field="completed"></p-sortIcon></th>
        <th >Edit/Delete</th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-todo let-editing="editing">
    <tr [class.completed]="todo.copmleted" [pEditableRow]="todo">
        <td>
          <p-tableCheckbox [value]="todo"  ></p-tableCheckbox>
        </td>

        <td>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <div class="edit-fields">
                  <input pInputText type="text" [(ngModel)]="todo.title">
                  <textarea pInputTextarea [(ngModel)]="todo.description" placeholder="Description..." rows="4" [autoResize]="true"></textarea>
              </div>
            </ng-template>

            <ng-template pTemplate="output">
             <h3>{{todo.title}}</h3>
             <p>{{todo.description}}</p>
            </ng-template>
          </p-cellEditor>
        </td>

        <td>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <p-dropdown [(ngModel)]="todo.status" [options]="todoService.m.statusOption" appendTo="body">
                <ng-template pTemplate="selectedItem">
                  <p-tag [severity]="todoService.getSeverity(todo.status)" [value]="todo.status"></p-tag>
                </ng-template>

                <ng-template let-option pTemplate="item">
                  <p-tag [severity]="todoService.getSeverity(option.value)" [value]="option.value"></p-tag>
                </ng-template>
              </p-dropdown>
            </ng-template>

            <ng-template pTemplate="output">
              <p-tag [severity]="todoService.getSeverity(todo.status)" [value]="todo.status"></p-tag>
            </ng-template>
          </p-cellEditor>
        </td>

        <td>
          <div class="flex align-items-center justify-content-center gap-2">
            <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow icon="pi pi-pencil" (click)="onRowEditInit(todo)" class="p-button-rounded p-button-success mr-2"></button>
            <button *ngIf="!editing" class="p-button-rounded p-button-danger mr-2" (click)="todoService.deleteTodo(todo)" style="margin-left: 3px;" icon="pi pi-trash" type="button" pButton pRipple></button>
            <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow icon="pi pi-check" (click)="onRowEditSave(todo)" class="p-button-rounded p-button-text p-button-success mr-2"></button>
            <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow icon="pi pi-times" (click)="onRowEditCancel(todo)" class="p-button-rounded p-button-text p-button-danger"></button>
          </div>
        </td>
    </tr>
  </ng-template>
</p-table>

